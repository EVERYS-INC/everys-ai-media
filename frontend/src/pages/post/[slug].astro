---
import ArticleLayout from "../../layouts/ArticleLayout.astro";
import { marked } from 'marked';

// ... その他のインポートと関数 ...

const { post } = Astro.props;

// 人気の記事を取得
const popularPostsResponse = await fetch(
  `${strapiUrl}/api/posts?sort[0]=viewCount:desc&pagination[limit]=5&fields[0]=title&fields[1]=slug`
);
const { data: popularPosts } = await popularPostsResponse.json();

// 最新の記事を取得
const recentPostsResponse = await fetch(
  `${strapiUrl}/api/posts?sort[0]=createdAt:desc&pagination[limit]=5&fields[0]=title&fields[1]=slug`
);
const { data: recentPosts } = await recentPostsResponse.json();

const content = marked(post.attributes.content);
---

<ArticleLayout 
  title={post.attributes.title} 
  recentPosts={recentPosts}
  popularPosts={popularPosts}
>
  <article>
    <h1 class="text-3xl font-bold mb-4">{post.attributes.title}</h1>
    <div set:html={content} />
  </article>
</ArticleLayout>